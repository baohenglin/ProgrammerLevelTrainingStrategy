## 读文档还是读代码？

"Code Tells You How, Comments Tell You Why"------Jeff Atwood

* 代 码 => What, How & Details
* 文档 / 书 => What, How & Why

代码会告诉你细节，但代码不会告诉你why。文档/书会告诉你Why，Why是能让人一通百通的东西，也是能让人醍醐灌顶的东西。书和文档是人之间的对话，代码是人和机器之间的对话。所以如果你想知道为什么要这么搞，那么应该去看书(像 Effective C++、Code Complete、Design Pattern、Thinking in Java等)，看文档；如果你要知道让机器干了什么？那你应该去看代码。

如果你想了解一种思想，一种方法，一种原理，一种思路，一种经验，恐怕读书和读文档会更有效率一些。因为其中会有作者的思路描述，比如Effective C++，里面有很多对不同用法和设计的推敲，TCP/IP详解里面也会有对TCP算法好坏的比较......这些思维方式能让你对技术的把握能力更强，而只看代码很难达到这种级别。

如果你想了解的就是具体细节，比如某协程的实现，某个模块的性能，某个算法的实现，那么你还是要去读代码的，因为代码中会有更具体的处理细节。

很多时候我们在 Google、Stack Overflow、GitHub过后，你会发现，你掌握的知识就是一块一块的碎片，既不系统，也不结构化，更别说融会贯通了。你会觉得自己需要好好地读一本书，系统地掌握知识。

很多时候，在读别人代码的时候，你会因为基础知识或是原理不懂，或是你在不知道为什么的情况下，要么完全读不懂代码，要么会误解代码。比如，如果你没有C语言和TCP原理方面的基础知识，就根本读不懂Linux下 TCP 的相关代码。我们因为误解代码用意而去修改代码造成的故障还少吗？

很多时候，看到一个算法或是一个设计时，比如Paxos，你是不是想去看一下这个算法的实现代码是什么样的？思考一下如何才能实现得好？

类似的情况还有很多，至于从代码中收获大还是从书中收获大，在不同的场景、不同的目的下，会有不同的答案。人对新事物的学习过程基本都是从“感性认识”渐进到“理性认识”的。如果你是新手，那么应该多读代码，多动手写代码。新手阶段处于感性认识阶段，这个时候即便告诉你Why你可能也体会不到。这个阶段你要的不是做漂亮，而是做出来。如果你是个老手，你已经有很多的“感性认识”了，那么此时你的成长需要更多的“理性认识”。因为这个阶段，一方面你会不满足于做出来，你想去做出更牛更漂亮的东西；另一方面你知道的越多，你的问题也越多，你迫切地需要知道Why！此时，你需要大量地找牛人交流（读牛人的书，是一种特殊的交流方式），所以这个阶段，需要读好的书和文章。

## 如何阅读源代码？

* 1. 基础知识。先具备相关的语言和基础技术的知识
* 2. 软件功能。先了解软件有哪些功能？有哪些特性？
* 3. 相关文档。先读一下相关文档，比如需求文档、用户手册、接口文档等
* 4. 代码的组织结构。了解代码目录中每个目录是什么样的功能。

先初步了解软件的大致设计结构和功能，接下来，就要了解软件的代码是由哪些部分构成的？

(1)接口抽象定义

(2)模块粘合层。我们的代码很多都是用来粘合代码的，比如中间件（middleware）、Promises模式、回调（Callback）、代理委托、依赖注入等。这些代码模块间的粘合技术是非常重要的。

(3)业务流程。可以画程序流程图或者时序图

(4)具体实现。阅读代码具体实现细节，可以从**代码逻辑**、**错误处理**、**数据处理**、**重要算法**、**底层交互**等方面切入。

(5)运行时调试。利用日志、debug设置断点等跟踪程序运行情况。


总的来说，阅读代码的方法如下：

* 一般采用自顶向下，从总体到细节的“剥洋葱皮”的读法
* 画图是必要的，程序流程图，调用时序图，模块组织图
* 代码逻辑归一下类，理清是业务逻辑还是控制逻辑，排除杂音，主要逻辑才会更清楚
* debug跟踪一下代码是了解代码在执行过程中发生了什么的最好方式。




